<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <!-- This inline task iterates over two Item-Arrays - msbuild batching simply can't. -->
    <!-- TODO: This task should probably be in a dll with some tests.. -->
    <UsingTask 
        TaskName="$(CakeContribGuidelinesCustomTasksNamespace).CheckPrivateAssetsOnReferences" 
        AssemblyFile="$(CakeContribGuidelinesCustomTasksAssembly)"/>

    <Target
        Name="_CheckCakeReferenceIsPrivateIterator"
        AfterTargets="BeforeBuild"
        BeforeTargets="CoreBuild">
        <ItemGroup>
            <CakeContribGuidelinesPrivateReference Include="Cake.Core" />
            <CakeContribGuidelinesPrivateReference Include="Cake.Common" />
            <CakeContribGuidelinesPrivateReference Include="CakeContrib.Guidelines" />
            <CakeContribGuidelinesPrivateReference Include="Cake.Addin.Analyzer" />
        </ItemGroup>

        <CheckPrivateAssetsOnReferences
            Condition="($(CakeContribGuidelinesCakeReferenceOmitPrivateCheck) == '')"
            PackagesToCheck="@(CakeContribGuidelinesPrivateReference)"
            References="@(PackageReference)" />
    </Target>

</Project>
